#+TITLE: Emacs configuration
* Your customizations
  You will need to tell Emacs a little about your particular setup:

  First, let Emacs know where it is you keep your =.bib= file:


  #+BEGIN_SRC emacs-lisp
    (defvar my/bib-file-location "~/.emacs.d/research.bib"
      "Where I keep my bib file.")
  #+END_SRC
* Emacs package management
  This section sets up emacs' package management system. MELPA and ELPA are the two biggest repos for packages. Windows is a pain because it doesn't work well with =https= so we have to fallback to =http=. The second thing we do here is to make sure that [[https://github.com/jwiegley/use-package][use-package]] is installed:

  #+BEGIN_SRC emacs-lisp
    (require 'package)
    (setq package-enable-at-startup nil)

    ;; Windows has issues using https:// instead of http:// so we want to
    ;; set the package locations to use the secure connection when they
    ;; can:
    (cond
     ((string-equal system-type "windows-nt") ; Microsoft Windows
      (progn
        (setq package-archives
              '(("melpa" . "http://melpa.org/packages/")
                ("elpa" . "http://elpa.gnu.org/packages/")))))
     ((or (string-equal system-type "gnu/linux") (string-equal system-type "darwin")) ; Linux & Mac OS X
      (progn
        (setq package-archives
              '(("melpa" . "https://melpa.org/packages/")
                ("elpa" . "https://elpa.gnu.org/packages/"))))))

    (package-initialize)

    ;; We'll use the use-package package to mange our config. Make sure
    ;; it's installed:
    (unless (package-installed-p 'use-package)
      (package-refresh-contents)
      (package-install 'use-package))

    ;; Make use-package available for use:
    (eval-when-compile
      (require 'use-package))
    (require 'bind-key)

  #+END_SRC
* Dealing with default emacs
  Emacs was created probably before you were born, which makes it super ancient in computer terms. In this section, we override some of the (now) silly default behavior so that emacs acts more like we expect a program to act in the 21st century. We'll load up some better default settings, activate auto-completion, and enable a smart way of dealing with pairs (e.g. parentheses, quotes, etc)

  In particular, we load =better-defaults=, a package that selects some better default settings for Emacs. it you're interested what it does, you can look at it [[https://github.com/technomancy/better-defaults][on github]]:

  #+BEGIN_SRC emacs-lisp
    (setq use-package-verbose t) ;; see which package is loaded slowly
    (delete-selection-mode) ; if I select something then type, delete it and replace it
    (use-package better-defaults
      :ensure t)
    (menu-bar-mode) ; better-defaults disables this but it's useful when you're getting used to Emacs
    (setq scroll-conservatively 1000) ; when point moves offscreen, don't jump to recenter it
    (setq visible-bell nil) ; fix for bug in Mac, see http://stuff-things.net/2015/10/05/emacs-visible-bell-work-around-on-os-x-el-capitan/
    (setq ring-bell-function 'ignore)
  #+END_SRC

  In my world, =C-z= is undo, not minimize emacs:

  #+BEGIN_SRC emacs-lisp
    ;; comment this part since I use Evil
    ;; (global-set-key (kbd "C-z") #'undo)
  #+END_SRC

  We also want words to wrap around nicely. The default behavior wraps in the middle of a word, which is awful:

  #+BEGIN_SRC emacs-lisp
    (global-visual-line-mode)
  #+END_SRC


    
  #+BEGIN_SRC emacs-lisp
    ;; deletes all the whitespace when you hit backspace or delete
    (use-package hungry-delete
      :ensure t
      :config
      (global-hungry-delete-mode))
  #+END_SRC

** Font

   The default font size(10pt) is too small for me personally, so I want to rescale it a little bit. Also, set Chinese fonts to solve coding problem.

  #+BEGIN_SRC emacs-lisp
    (set-face-attribute 'default nil :height 140)
    
    ;; [[http://zhuoqiang.me/torture-emacs.html][Font setting comes here.]]
    ;; Setting English Font
    (set-face-attribute 'default nil :font "Consolas 14")
    
    ;; Chinese Font
    (dolist (charset '(kana han symbol cjk-misc bopomofo))
      (set-fontset-font (frame-parameter nil 'font)
                        charset (font-spec :family "Microsoft YaHei"
                                           :size 14)))   
    ;; font scaling
    (defhydra hydra-zoom (global-map "<f2>")
       "zoom"
       ("i" text-scale-increase "in")
       ("d" text-scale-decrease "out")
       ("0" (text-scale-adjust 0) "reset")
       ("q" nil "quit" :color blue))
  #+END_SRC

** Fix for Mac
   Emacs on Mac sometimes can't find installed programs (e.g. R, spellcheck). This fixes that:

   #+BEGIN_SRC emacs-lisp
     (when (memq window-system '(mac ns))
       (use-package exec-path-from-shell
         :ensure t
         :config
         (exec-path-from-shell-initialize)))
   #+END_SRC
** Auto completion 
   We'll use =company= (short for "complete anything") to do auto-completion. This will, for example, enable the same kind of pop-up messages that mimic [[https://support.rstudio.com/hc/en-us/articles/205273297-Code-Completion][Rstudio's autocomplete features]]. As of this writing (August 2016), Emacs' autocompletion isn't quite as good as Rstudios. In particular, it won't pick up on variables from =data.frames= that you've passed to e.g. =dplyr= functions through piping calls. (e.g. ~mtcars %>% filter()~) won't give you =mpg= as an option inside the filter statement. Having said that, =company= does a really good job:

   #+BEGIN_SRC emacs-lisp
     (use-package company
       :ensure t
       :config
       (add-hook 'after-init-hook #'global-company-mode)
       :config
       (define-key company-active-map (kbd "<tab>")
         (lambda () (interactive) (company-complete-common-or-cycle 1)))
       (use-package company-quickhelp
         :ensure t
         :config
         (company-quickhelp-mode 1))
         (setq company-quickhelp-delay nil))  ;;set to nil to avoid automatically pop up help html
   #+END_SRC

** Smartparens
   This package will help you deal with matching pairs (e.g. (), "", etc) by automatically inserting the closing pair when you open it and allowing you to "wrap" expressions that are selected (in other words, if you've already written something and you realize you want it in quotes/parens, just highlight it and press the " or ( ):

   #+BEGIN_SRC emacs-lisp
     (use-package smartparens
       :ensure t
       :init
       (require 'smartparens-config)
       (smartparens-global-mode)
       (show-smartparens-global-mode))
   #+END_SRC

** Backup files
   I want emacs to make these, but don't want to clutter up my project folders with tons of backup files. Solution: put them in the ~.emacs.d/~ directory.
   #+BEGIN_SRC emacs-lisp
     (setq backup-directory-alist
           `(("." . ,(expand-file-name
                      (concat user-emacs-directory "backups")))))
   #+END_SRC
   
** Spell check 
   We can use =flyspell= for on-the-fly spell checking, similar to what we get with MS Word or whatever. =C-;= runs =flyspell-auto-correct-previous-word= which automatically corrects the last word still on screen. If it doesn't guess right the first time, press it again. 
   #+BEGIN_SRC emacs-lisp
     (use-package flyspell
       :ensure t
       :init
       ;;While it always spells a flyspell enabling error message, 
       ;;which is a kind of anonying.
       (setq flyspell-issue-welcome-flag nil) ;; fix flyspell problem
       :config
       (when (eq system-type 'windows-nt) ;; comes from here: https://github.com/voltecrus/emacs.d-1/blob/master/init.el
         (add-to-list 'exec-path "C:/Program Files (x86)/Aspell/bin/"))
       (setq ispell-program-name "aspell" ; use aspell instead of ispell
        ispell-extra-args '("--sug-mode=ultra" "--lang=en_US"))
       (add-hook 'text-mode-hook #'turn-on-flyspell)
       (add-hook 'prog-mode-hook #'flyspell-prog-mode)
       (add-hook 'ess-mode-hook #'flyspell-prog-mode))
   #+END_SRC
   
** Themes and mode-line
   I have tried a lot of themes, but none is satisfying. Try this again.
   
   Smart Mode Line is a sexy mode-line for Emacs. It aims to be easy to read from small to large monitors by using colors, a prefix feature, and smart truncation.

   #+BEGIN_SRC emacs-lisp
     ;;(use-package apropospriate-theme
     ;;  :disabled
     ;;  :ensure t
     ;;  :config
     ;;  (load-theme 'apropospriate-light t))  

     ;; https://github.com/abo-abo/eclipse-theme.git
     (use-package eclipse-theme
       :disabled
       :ensure t
       :defer t
       :init (load-theme 'eclipse t))

     (use-package spacemacs-theme
       :disabled
       :defer t
       :ensure t
       :init (load-theme 'spacemacs-light t))

     (use-package color-theme-sanityinc-tomorrow
       :disabled
       :ensure t
       :config
       (progn
         (load-theme 'sanityinc-tomorrow-day t)))

     (use-package leuven-theme
       :ensure t
       :config
       (progn
         (load-theme 'leuven t)))

     ;;smart-line-mode
     (use-package smart-mode-line
       :disabled
       :ensure t
       :init
       (progn
         (setq sml/no-confirm-load-theme t)
         (sml/setup)))

     (use-package spaceline
       :ensure t
       :defer 5
       :init
       :config
       (setq spaceline-highlight-face-func 'spaceline-highlight-face-evil-state)
       (require 'spaceline-config)
       (spaceline-spacemacs-theme))
   #+END_SRC

** Restart Emacs
  The heading says it all. 
  
   #+BEGIN_SRC emacs-lisp
   (use-package restart-emacs
     :ensure t
     :bind* (("C-x M-c" . restart-emacs)))
   #+END_SRC

** Highlight

  #+BEGIN_SRC emacs-lisp
    (use-package volatile-highlights
      :ensure t
      :defer t
      :diminish volatile-highlights-mode
      :config
      (volatile-highlights-mode t))
    
    (global-hl-line-mode t) ;; this turns on highlight line mode. It makes it easy to see the line the cursor's on.
    
    ;; flashes the cursor's line when you scroll
    (use-package beacon
      :ensure t
      :config
      (beacon-mode 1)
      )
  #+END_SRC

** Undo-tree
   #+BEGIN_SRC emacs-lisp
     (use-package undo-tree
      :ensure t
      :init
      (global-undo-tree-mode))
   #+END_SRC 

** Rectangle editing
   #+BEGIN_SRC emacs-lisp
     (defhydra hydra-rectangle (:body-pre (rectangle-mark-mode 1)
                           :color red 
                           :post (deactivate-mark))
       "
       ^_k_^        _d_elete        _s_tring      _e_xchange  
     _h_   _l_      _o_k            _y_ank        _p_aste 
       ^_j_^        _n_ew-copy      _r_eset       _u_ndo
     "
       ("h" backward-char nil)
       ("l" forward-char nil)
       ("k" previous-line nil)
       ("j" next-line nil)
       ("e" exchange-point-and-mark nil)
       ("n" copy-rectangle-as-kill nil)
       ("d" delete-rectangle nil)
       ("r" (if (region-active-p)
                (deactivate-mark)
              (rectangle-mark-mode 1)) nil)
       ("y" yank-rectangle nil)
       ("u" undo nil)
       ("s" string-rectangle nil)
       ("p" kill-rectangle nil)
       ("o" nil nil))
     (global-set-key (kbd "C-x SPC") 'hydra-rectangle/body) 
   #+END_SRC

** Centering-window
   Global minor mode that centers the text of the window. If another window is visible the text goes back to normal if its width is less than cwm-centered-window-width.
   #+BEGIN_SRC emacs-lisp
     (use-package centered-window-mode
      :ensure t
      :config (centered-window-mode t))
   #+END_SRC 

* Hydra
  This is a package for GNU Emacs that can be used to tie related commands into a family of short bindings with a common prefix - a Hydra.

  #+BEGIN_SRC emacs-lisp
  ;; this configuration comes from [[https://github.com/joedicastro/dotfiles/blob/master/emacs/.emacs.d/readme.org][here]].
    (use-package hydra
      :ensure t
      :defer 0.1
      :init
      (bind-key "<f6>" 'hydra-master/body)
      :config
      (setq lv-use-separator t)
      (set-face-attribute 'hydra-face-blue nil :foreground "deep sky blue" :weight 'bold)
  
      (eval-and-compile
        (defhydra hydra-common (:color blue)
          ("<ESC>" nil "quit")))
  
      (defhydra hydra-master (:color blue :idle 0.4)
        "
                                                                           ╭───────┐
                                                                           │ Index │
    ╭──────────────────────────────────────────────────────────────────────┴───────╯
      [_a_] bookmarks    [^h^]               [_o_] organization  [^v^] 
      [_b_] buffers      [_i_] internet      [_p_] project       [_w_] window
      [_c_] flycheck     [_j_] jump          [_q_] exit          [_x_] shell
      [_d_] development  [_k_] spell         [_r_] register      [^y^]
      [_e_] emacs        [_l_] lisp          [_s_] search        [^z^]
      [_f_] file         [_m_] media         [_t_] text
      [_g_] git          [_n_] narrow        [^u^]
    --------------------------------------------------------------------------------
        "
        ("<SPC>" joe-alternate-buffers "alternate buffers")
        ("<ESC>" nil "quit")
        ("\\" (insert "\\") "\\")
        ("a"     hydra-bookmarks/body nil)
        ("b"     hydra-buffers/body nil)
        ("c"     hydra-flycheck/body nil)
        ("d"     hydra-development/body nil)
        ("e"     hydra-emacs/body nil)
        ("f"     hydra-file/body nil)
        ("g"     hydra-git/body nil)
        ("i"     hydra-internet/body nil)
        ("j"     hydra-jump/body nil)
        ("k"     hydra-spell/body nil)
        ("l"     hydra-lisp/body nil)
        ("m"     hydra-media/body nil)
        ("n"     hydra-narrow/body nil)
        ("o"     hydra-organization/body nil)
        ("p"     hydra-project/body nil)
        ("q"     hydra-exit/body nil)
        ("r"     hydra-register/body nil)
        ("s"     hydra-search/body nil)
        ("t"     hydra-text/body nil)
        ("w"     ace-window nil)
        ("x"     hydra-system/body nil))
  
      (defhydra hydra-bookmarks (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
        "
                                                                       ╭───────────┐
           List                          Do                            │ Bookmarks │
    ╭──────────────────────────────────────────────────────────────────┴───────────╯
      [_l_] list bookmarks            [_j_] jump to a bookmark
       ^ ^                            [_m_] set bookmark at point
       ^ ^                            [_s_] save bookmarks
    --------------------------------------------------------------------------------
        "
        ("l" counsel-bookmark)
        ("j" bookmark-jump)
        ("m" bookmark-set)
        ("s" bookmark-save))
  
      (defhydra hydra-buffers (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
        "
                                                                         ╭─────────┐
      Switch                 Do                                          │ Buffers │
    ╭────────────────────────────────────────────────────────────────────┴─────────╯
      [_b_] switch             [_d_] kill the buffer
      [_i_] ibuffer            [_r_] toggle read-only mode
      [_a_] alternate          [_u_] revert buffer changes
       ^ ^                     [_w_] save buffer
    --------------------------------------------------------------------------------
        "
        ("a" joe-alternate-buffers)
        ("b" ivy-switch-buffer)
        ("d" kill-this-buffer)
        ("i" ibuffer)
        ("r" read-only-mode)
        ("u" joe-revert-buffer)
        ("w" save-buffer))
  
        (defhydra hydra-flycheck (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                        ╭──────────┐
       Navigate          Show Errors                  Do                │ Flycheck │
    ╭───────────────────────────────────────────────────────────────────┴──────────╯
       ^_p_^revious     [_l_] list errors           [_t_] toggle Flycheck
          ^^↑^^         [_d_] clear all errors      [_c_] select checker
        ^_f_^irst        ^ ^                        [_r_] run via compile
          ^^↓^^          ^ ^                        [_h_] describe checker
        ^_n_^ext
    --------------------------------------------------------------------------------
          "
          ("c" flycheck-select-checker)
          ("h" flycheck-describe-checker)
          ("d" flycheck-clear)
          ("f" flycheck-first-error)
          ("l" flycheck-list-errors)
          ("n" flycheck-next-error :color red)
          ("p" flycheck-previous-error :color red)
          ("r" flycheck-compile)
          ("t" flycheck-mode))
  
        (defhydra hydra-development (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                     ╭─────────────┐
         Code                   Web                 Quickrun         │ Development │
    ╭────────────────────────────────────────────────────────────────┴─────────────╯
      [_d_] search docs (at point) [_c_] Web Colors          [_q_] buffer
       ^ ^                         [_h_] HTTP header         [_v_] region
       ^ ^                         [_m_] HTTP method         [_x_] shell
       ^ ^                         [_r_] HTTP relation       [_p_] with arg
       ^ ^                         [_s_] HTTP status code    [_o_] only compile
       ^ ^                         [_t_] Media types         [_R_] replace
       ^ ^                         [_g_] RESTclient          [_e_] eval/print
       ^ ^                         [_f_] RFC doc
      [_l_] lines of code          [_F_] RFC index
    --------------------------------------------------------------------------------
          "
          ("d" devdocs-search)
          ("c" counsel-colors-web)
          ("g" restclient-mode)
          ("f" irfc-visit)
          ("F" irfc-index)
          ("q" quickrun)
          ("v" quickrun-region)
          ("x" quickrun-shell)
          ("p" quickrun-with-arg)
          ("o" quickrun-compile-only)
          ("R" quickrun-replace-region)
          ("e" quickrun-eval-print)
          ("h" http-header)
          ("m" http-method)
          ("r" http-relation)
          ("s" http-status-code)
          ("t" media-type)
          ("l" cloc))
  
      (defhydra hydra-emacs (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                           ╭───────┐
       Execute       Packages         Help                     Misc        │ Emacs │
    ╭──────────────────────────────────────────────────────────────────────┴───────╯
      [_x_] counsel M-x [_p_] list      [_f_] describe function [_t_] change theme
       ^ ^              [_i_] install   [_v_] describe variable [_l_] list emacs process
       ^ ^              [_u_] upgrade   [_m_] info manual       [_c_] init time
       ^ ^               ^ ^            [_k_] bindings          [_e_] benchmark init
       ^ ^               ^ ^            [_b_] personal bindings [_o_] unbound commands 
       ^ ^               ^ ^             ^ ^                    [_y_] emacs colors
       ^ ^               ^ ^             ^ ^                    [_z_] list faces
    --------------------------------------------------------------------------------
          "
          ("C-h b" counsel-descbinds "bindings")
          ("f" counsel-describe-function)
          ("v" counsel-describe-variable)
          ("b" describe-personal-keybindings)
          ("c" emacs-init-time)
          ("i" package-install)
          ("k" counsel-descbinds)
          ("l" list-processes)
          ("m" info-display-manual)
          ("p" paradox-list-packages)
          ("t" counsel-load-theme)
          ("u" paradox-upgrade-packages)
          ("e" esup)
          ("o" smex-show-unbound-commands)
          ("y" counsel-colors-emacs)
          ("z" counsel-faces)
          ("x" counsel-M-x))
  
      (defhydra hydra-file (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                            ╭──────┐
         Ivy                    Dired        Ztree                          │ File │
    ╭───────────────────────────────────────────────────────────────────────┴──────╯
      [_o_] open file        [_d_] dired         [_z_] diff dirs
      [_e_] open file extern [_r_] ranger
    --------------------------------------------------------------------------------
          "
          ("o" counsel-find-file)
          ("e" counsel-find-file-extern)
          ("z" ztree-diff)
          ("d" dired)
          ("r" ranger))
  
  
      (defhydra hydra-text (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                            ╭──────┐
     Size  Toggle              Unicode                        Do            │ Text │
    ╭───────────────────────────────────────────────────────────────────────┴──────╯
      _k_  [_f_] fill column     [_d_] unicode character           [_a_] align with regex
      ^↑^  [_h_] hidden chars    [_e_] evil digraphs table         [_w_] remove trailing ' '
      ^ ^  [_l_] line numbers    [_s_] specific code block         [_n_] count words
      ^↓^  [_t_] trailing ' '    [_u_] unicode character           [_i_] lorem ipsum
      _j_  [_v_] font space      [_p_] character code              [_x_] comment box
      ^ ^  [_c_] comment          ^ ^                              [_q_] boxquote
      ^ ^  [_b_] multibyte chars  ^ ^                              [_m_] iedit (multiple)
      ^ ^   ^ ^                   ^ ^                              [_r_] expand region
      ^ ^   ^ ^                   ^ ^                              [_U_] tabs to spaces
    --------------------------------------------------------------------------------
          "
          ("a" align-regexp)
          ("b" toggle-enable-multibyte-characters)
          ("c" comment-line)
          ("d" insert-char)
          ("e" evil-ex-show-digraphs)
          ("f" fci-mode)
          ("h" whitespace-mode)
          ("i" lorem-ipsum-insert-paragraphs)
          ("k" text-scale-increase :color red)
          ("j" text-scale-decrease :color red)
          ("l" linum-mode)
          ("n" count-words)
          ("m" iedit)
          ("p" describe-char)
          ("r" er/expand-region)
          ("s" charmap)
          ("t" joe-toggle-show-trailing-whitespace)
          ("u" counsel-unicode-char)
          ("v" variable-pitch-mode)
          ("w" whitespace-cleanup)
          ("U" untabify)
          ("q" hydra-boxquote/body)
          ("x" comment-box))
  
      (defhydra hydra-git (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                             ╭─────┐
       Magit                          VC                    Timemachine      │ Git │
    ╭────────────────────────────────────────────────────────────────────────┴─────╯
      [_s_] status              [_d_] diffs between revisions  [_t_] timemachine
      [_B_] blame mode          [_b_] edition history
      [_l_] file log
    --------------------------------------------------------------------------------
          "
          ("B" magit-blame-mode)
          ("b" vc-annotate)
          ("d" vc-diff)
          ("l" magit-file-log)
          ("s" magit-status)
          ("t" git-timemachine))
  
      (defhydra hydra-internet (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                        ╭──────────┐
        Browse       Search              Social               Post      │ Internet │
    ╭───────────────────────────────────────────────────────────────────┴──────────╯
      [_w_] eww      [_b_] DuckDuckGo       [_f_] elfeed            [_i_] imgur
      [_u_] url      [_e_] DuckDuckGo (eww) [_x_] stack overflow
       ^ ^           [_m_] google maps
       ^ ^           [_d_] wordnik
    --------------------------------------------------------------------------------
          "
          ("w" eww)
          ("u" browse-url-at-point)
          ("b" (joe-duckduckgo-search t))
          ("e" (joe-duckduckgo-search nil))
          ("m" google-maps)
          ("d" define-word-at-point)
          ("f" elfeed)
          ("x" sx-tab-newest)
          ("i" imgur-post))
  
      (defhydra hydra-jump (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                            ╭──────┐
      Window          Word/Char        Line         iSearch                 │ Jump │
    ╭───────────────────────────────────────────────────────────────────────┴──────╯
      [_w_] jump        [_j_] word         [_l_] jump     [_i_] jump
      [_d_] close       [_p_] all words    [_y_] copy
      [_z_] maximize    [_b_] subword      [_m_] move
      [_s_] swap        [_c_] char         [_v_] copy region
       ^ ^              [_a_] two chars
    --------------------------------------------------------------------------------
          "
          ("w" ace-window)
          ("d" ace-delete-window)
          ("z" ace-maximize-window)
          ("s" ace-swap-window)
          ("j" avy-goto-word-1)
          ("p" avy-goto-word-0)
          ("b" avy-goto-subword-0)
          ("c" avy-goto-char)
          ("a" avy-goto-char-2)
          ("l" avy-goto-line)
          ("y" avy-copy-line)
          ("m" avy-move-line)
          ("v" avy-copy-region)
          ("i" avy-isearch))
  
      (defhydra hydra-spell (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                           ╭───────┐
        Flyspell               Ispell                      Gtranslate      │ Spell │
    ╭──────────────────────────────────────────────────────────────────────┴───────╯
      [_k_] correct word       [_w_] check word            [_g_] en ⇆ es
      [_n_] next error         [_t_] toggle dictionary     [_G_] any lang
      [_f_] toggle flyspell    [_d_] change dictionary
      [_p_] toggle prog mode
    --------------------------------------------------------------------------------
          "
          ("w" ispell-word)
          ("d" ispell-change-dictionary)
          ("t" joe-switch-dictionary)
          ("g" google-translate-smooth-translate)
          ("G" google-translate-query-translate)
          ("f" flyspell-mode)
          ("p" flyspell-prog-mode)
          ("k" flyspell-correct-word-generic)
          ("n" flyspell-goto-next-error))
  
      (defhydra hydra-lisp (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                            ╭──────┐
        Elisp              Bug hunter                                       │ Lisp │
    ╭───────────────────────────────────────────────────────────────────────┴──────╯
      [_r_] eval region    [_f_] file
      [_s_] eval sexp      [_i_] init-file
      [_b_] eval buffer
    --------------------------------------------------------------------------------
          "
          ("f" bug-hunter-file)
          ("i" bug-hunter-init-file)
          ("r" eval-region)
          ("b" eval-buffer)
          ("s" eval-last-sexp))
  
      (defhydra hydra-narrow (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                          ╭────────┐
        Narrow                                                            │ Narrow │
    ╭─────────────────────────────────────────────────────────────────────┴────────╯
      [_f_] narrow to defun
      [_p_] narrow to page
      [_r_] narrow to region
      [_w_] widen
    --------------------------------------------------------------------------------
          "
          ("f" narrow-to-defun)
          ("p" narrow-to-page)
          ("r" narrow-to-region)
          ("w" widen))
  
      (defhydra hydra-project (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                      ╭────────────┐
      Files             Search          Buffer             Do         │ Projectile │
    ╭─────────────────────────────────────────────────────────────────┴────────────╯
      [_f_] file          [_a_] ag          [_b_] switch         [_g_] magit
      [_l_] file dwim     [_A_] grep        [_v_] show all       [_p_] commander
      [_r_] recent file   [_s_] occur       [_V_] ibuffer        [_i_] info
      [_d_] dir           [_S_] replace     [_K_] kill all
      [_o_] other         [_t_] find tag
      [_u_] test file     [_T_] make tags
      [_h_] root
                                                                          ╭────────┐
      Other Window      Run             Cache              Do             │ Fixmee │
    ╭──────────────────────────────────────────────────╯ ╭────────────────┴────────╯
      [_F_] file          [_U_] test        [_kc_] clear         [_x_] TODO & FIXME
      [_L_] dwim          [_m_] compile     [_kk_] add current   [_X_] toggle
      [_D_] dir           [_c_] shell       [_ks_] cleanup
      [_O_] other         [_C_] command     [_kd_] remove
      [_B_] buffer
    --------------------------------------------------------------------------------
          "
          ("a"   projectile-ag)
          ("A"   projectile-grep)
          ("b"   projectile-switch-to-buffer)
          ("B"   projectile-switch-to-buffer-other-window)
          ("c"   projectile-run-async-shell-command-in-root)
          ("C"   projectile-run-command-in-root)
          ("d"   projectile-find-dir)
          ("D"   projectile-find-dir-other-window)
          ("f"   projectile-find-file)
          ("F"   projectile-find-file-other-window)
          ("g"   projectile-vc)
          ("h"   projectile-dired)
          ("i"   projectile-project-info)
          ("kc"  projectile-invalidate-cache)
          ("kd"  projectile-remove-known-project)
          ("kk"  projectile-cache-current-file)
          ("K"   projectile-kill-buffers)
          ("ks"  projectile-cleanup-known-projects)
          ("l"   projectile-find-file-dwim)
          ("L"   projectile-find-file-dwim-other-window)
          ("m"   projectile-compile-project)
          ("o"   projectile-find-other-file)
          ("O"   projectile-find-other-file-other-window)
          ("p"   projectile-commander)
          ("r"   projectile-recentf)
          ("s"   projectile-multi-occur)
          ("S"   projectile-replace)
          ("t"   projectile-find-tag)
          ("T"   projectile-regenerate-tags)
          ("u"   projectile-find-test-file)
          ("U"   projectile-test-project)
          ("v"   projectile-display-buffer)
          ("V"   projectile-ibuffer)
          ("X"   fixmee-mode)
          ("x"   fixmee-view-listing))
  
      (defhydra hydra-exit (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                            ╭──────┐
       Quit                                                                 │ Exit │
    ╭───────────────────────────────────────────────────────────────────────┴──────╯
      [_c_] exit emacs (standalone or client)
      [_s_] shutdown the emacs daemon
    --------------------------------------------------------------------------------
          "
          ("c" save-buffers-kill-terminal)
          ("s" save-buffers-kill-emacs))
  
      (defhydra hydra-register (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                        ╭──────────┐
       Logs                        Registers                Undo        │ Register │
    ╭───────────────────────────────────────────────────────────────────┴──────────╯
      [_c_] commands history       [^e^] emacs registers    [_u_] undo tree
      [_o_] messages               [_r_] evil registers
      [_l_] lossage (keystrokes)   [_m_] evil marks
      [_d_] diff buffer with file  [_k_] kill ring
    --------------------------------------------------------------------------------
          "
          ("d" joe-diff-buffer-with-file)
          ("k" counsel-yank-pop)
          ("l" view-lossage)
          ("c" counsel-command-history)
          ("m" evil-show-marks)
          ("o" view-echo-area-messages)
          ("r" evil-show-registers)
          ("u" undo-tree-visualize))
  
      (defhydra hydra-search (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                          ╭────────┐
       Files                             Buffer                           │ Search │
    ╭─────────────────────────────────────────────────────────────────────┴────────╯
      [_a_] regex search (Ag)           [_b_] by word
      [_r_] regex search (rg)           [_o_] by word (opened buffers)
      [_p_] regex search (pt)           [_w_] by word (multi)
      [_g_] regex search (grep)         [_h_] by word (grep or swiper)
      [^f^] find                        [_t_] tags & titles
      [_l_] locate                      [_s_] semantic 
    --------------------------------------------------------------------------------
          "
          ("a" (let ((current-prefix-arg "-."))
                 (call-interactively 'counsel-ag)))
          ("r" (let ((current-prefix-arg "-."))
                 (call-interactively 'counsel-rg)))
          ("p" (let ((current-prefix-arg "-."))
                 (call-interactively 'counsel-pt)))
          ("g" rgrep)
          ("l" counsel-locate)
          ("b" swiper)
          ("o" swiper-all)
          ("h" counsel-grep-or-swiper)
          ("t" counsel-imenu)
          ("s" counsel-semantic)
          ("w" swiper-multi))
  
      (defhydra hydra-system (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                          ╭────────┐
       Terminals                     System                               │ System │
    ╭─────────────────────────────────────────────────────────────────────┴────────╯
      [_s_] new multi-term           [_c_] shell command
      [_n_] next multi-term          [_a_] aync shell command
      [_p_] previous multi-term      [_m_] man page
      [_d_] dedicated multi-term     [_l_] list system process
      [_e_] eshell
    --------------------------------------------------------------------------------
          "
          ("a" async-shell-command)
          ("c" shell-command)
          ("e" eshell)
          ("m" man)
          ("l" proced)
          ("s" multi-term)
          ("n" multi-term-next)
          ("p" multi-term-previous)
          ("d" multi-term-dedicated-toggle))
  
      (defhydra hydra-media (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                           ╭───────┐
       Mingus              Mpd                     Volume                  │ Media │
    ╭──────────────────────────────────────────────────────────────────────┴───────╯
     [_m_] mingus         [_n_] next song          [_-_] volume down
     [_f_] search         [_p_] previous song      [_+_] volume up
     [_l_] playlist       [_c_] clear playlist
     [_a_] All            [_t_] pause
      ^ ^                 [_s_] stop
      ^ ^                 [_d_] start daemon
    --------------------------------------------------------------------------------
          "
          ("m" mingus)
          ("f" mingus-search)
          ("c" mingus-clear)
          ("n" mingus-next)
          ("p" mingus-prev)
          ("t" mingus-toggle)
          ("s" mingus-stop)
          ("d" mingus-start-daemon)
          ("l" mingus-load-playlist)
          ("a" mingus-load-all)
          ("-" mingus-vol-down)
          ("\+" mingus-vol-up))
  
      (defhydra hydra-organization (:color blue :hint nil :idle 0.4 :inherit (hydra-common/heads))
          "
                                                                    ╭──────────────┐
         Tasks            Org mode               Comms      Others  │ Organization │
    ╭───────────────────────────────────────────────────────────────┴──────────────╯
      [_a_] agenda      [_c_] capture             [_m_] mail      [_x_] speed type
      [_l_] agenda list [_p_] pomodoro            [_t_] contacts
      [_d_] calendar    [_s_] search headings     [_h_] add location
       ^ ^              [_g_] open location gmaps
       ^ ^              [_f_] archive subtree
    --------------------------------------------------------------------------------
          "
          ("a" org-agenda)
          ("c" org-capture)
          ("s" counsel-org-agenda-headlines)
          ("d" cfw:open-org-calendar)
          ("g" org-location-google-maps)
          ("h" org-address-google-geocode-set)
          ("l" org-agenda-list)
          ("f" org-archive-subtree)
          ("m" mu4e)
          ("p" org-pomodoro)
          ("t" org-contacts)
          ("x" speed-type-text))
  
       (defhydra hydra-leader ( :color blue :hint nil :idle 0.4)
           "
                                                                          ╭────────┐
       Toggle                        Do                                   │ Leader │
    ╭─────────────────────────────────────────────────────────────────────┴────────╯
      [_c_] comment                  [_a_] align with regex
      [_f_] fill column              [_p_] show character code
      [_h_] hidden chars             [_i_] insert unicode character 
      [_e_] trailing whitespace      [_<SPC>_] remove trailing whitespaces
      [_v_] font space               [_u_] undo tree
       ^ ^                           [_j_] jump word
       ^ ^                           [_x_] comment box
       ^ ^                           [_r_] expand region
       ^ ^                           [_m_] iedit (multiple edit)
       ^ ^                           [_g_] google translate
       ^ ^                           [_s_] swiper
       ^ ^                           [_t_] counsel imenu
       ^ ^                           [_q_] quick-calc
    --------------------------------------------------------------------------------
          "
          ("<escape>" nil "quit")
          ("a" align-regexp)
          ("c" comment-line)
          ("r" er/expand-region)
          ("f" fci-mode)
          ("g" google-translate-smooth-translate)
          ("h" whitespace-mode)
          ("i" counsel-unicode-char)
          ("j" avy-goto-word-1)
          ("m" iedit-mode)
          ("n" count-words)
          ("p" describe-char)
          ("e" joe-toggle-show-trailing-whitespace)
          ("u" undo-tree-visualize)
          ("v" variable-pitch-mode)
          ("<SPC>" whitespace-cleanup)
          ("s" joe-swiper)
          ("t" counsel-imenu)
          ("q" (quick-calc t))
          ("x" comment-box)))
  #+END_SRC

* R (ESS)
  ESS (short for Emacs Speaks Statistics) is the package that lets Emacs know about R and how it works. Let's load it up. No need to make sure that it is installed like we did with =use-package= in the previous section - =use-package= lets us just say "ensure" and will install it if it doesn't exist:  

  #+BEGIN_SRC emacs-lisp
    (use-package ess-site
      :ensure ess)
  #+END_SRC

** Stata
   Stata is not so fully supported as R in ESS, especially on Windows. See [[https://www.statalist.org/forums/forum/general-stata-discussion/general/1309287-how-to-use-stata-in-emacs-with-ess][here]] for a discussion. But we still get an option to use ado-mode, which is not perfect to let you run Stata in terminal on Windows, but is still great to work in Emacs. [[http://louabill.org/Stata/ado-mode_install.html][Configuration comes here.]] Also, ado-mode may be override by ESS, so we need to start if after ESS loaded, see [[https://www.statalist.org/forums/forum/general-stata-discussion/general/22851-ado-mode-emacs-and-ess][here]] for discussion.

  #+BEGIN_SRC emacs-lisp
     (add-to-list 'load-path "~/.emacs.d/ado-mode-1.14.2.0/lisp/")
     (require 'ado-mode)
  #+END_SRC
   
* Elpy
   Elpy is an Emacs package to bring powerful Python editing to Emacs. It combines and configures a number of other packages, both written in Emacs Lisp as well as Python.

   #+BEGIN_SRC emacs-lisp
     (use-package elpy
       :ensure t
       :defer t
       :config
       (elpy-enable))
   #+END_SRC

* Latex (AuCTeX)
  If you use latex to do any writing, you'll be happy to know that emacs is the highest-rated latex editor [[http://tex.stackexchange.com/questions/339/latex-editors-ides/][on stackexchange]].
  
  #+BEGIN_SRC emacs-lisp
    (use-package tex-site
      :ensure auctex
      :defer t
      :mode ("\\.tex\\'" . latex-mode)
      :config
      (setq TeX-auto-save t)
      (setq TeX-parse-self t)
      ;; Here we make auctex aware of latexmk and xelatexmk. We can use
      ;; these instead of calling pdflatex, bibtex, pdflatex, pdflatex (or
      ;; similar). I'll set latexmk as the default as there's really no
      ;; reason to use pdflatex
      (eval-after-load "tex"
        '(add-to-list 'TeX-command-list '("latexmk" "latexmk -synctex=1 -shell-escape -pdf %s" TeX-run-TeX nil t :help "Process file with latexmk")))
      (eval-after-load "tex"
        '(add-to-list 'TeX-command-list '("xelatexmk" "latexmk -synctex=1 -shell-escape -xelatex %s" TeX-run-TeX nil t :help "Process file with xelatexmk")))
      (add-hook 'LaTeX-mode-hook
                (lambda ()
                  (company-mode)
                  (smartparens-mode)
                  (turn-on-reftex)
                  (setq reftex-plug-into-AUCTeX t)
                  (reftex-isearch-minor-mode)
                  (setq TeX-command-default "latexmk")
                  (setq TeX-PDF-mode t)
                  (setq TeX-source-correlate-method 'synctex)
                  (setq TeX-source-correlate-start-server t)))
      ;; Update PDF buffers after successful LaTeX runs
      ;;(add-hook 'TeX-after-compilation-finished-functions #'TeX-revert-document-buffer)
      ;; see issue [[https://github.com/politza/pdf-tools/issues/128][here]]
      (require 'subr-x)
      (defun th/pdf-view-revert-buffer-maybe (file)
      (when-let ((buf (find-buffer-visiting file)))
      (with-current-buffer buf
      (when (derived-mode-p 'pdf-view-mode)
      (pdf-view-revert-buffer nil t)))))
      
      (add-hook 'TeX-after-compilation-finished-functions 
      #'th/pdf-view-revert-buffer-maybe)

      ;; to use pdfview with auctex
      (add-hook 'LaTeX-mode-hook 'pdf-tools-install)
      
      ;; to use pdfview with auctex
      (setq TeX-view-program-selection '((output-pdf "pdf-tools"))
             TeX-source-correlate-start-server t)
      (setq TeX-view-program-list '(("pdf-tools" "TeX-pdf-tools-sync-view"))))
       
       ;; use sumatra to view pdf, comment this since we get pdf-tools
       ;; http://stackoverflow.com/questions/14448606/sync-emacs-auctex-with-sumatra-pdf
       ;;(setq TeX-PDF-mode t)
       ;;(setq TeX-source-correlate-mode t)
       ;;(setq TeX-source-correlate-method 'synctex)
       ;;(setq TeX-view-program-list
       ;;   '(("Sumatra PDF" ("\"C:/Program Files/SumatraPDF/SumatraPDF.exe\" -reuse-instance"
       ;;                      (mode-io-correlate " -forward-search %b %n ") " %o"))))
       ;;
       ;;(eval-after-load 'tex
       ;;  '(progn
       ;;     (assq-delete-all 'output-pdf TeX-view-program-selection)
       ;;     (add-to-list 'TeX-view-program-selection '(output-pdf "Sumatra PDF")))))
  #+END_SRC
  
** Sumatra Pdf
   Sumatra pdf reader is a small but powerful pdf viewer, since I can't use pdf-tools on Windows right now, it's a good alternative, maybe.

* Pdf-tools
  PDF Tools is, among other things, a replacement of DocView for PDF files. The key difference is, that pages are not pre-rendered by e.g. ghostscript and stored in the file-system, but rather created on-demand and stored in memory.

This rendering is performed by a special library named, for whatever reason, poppler, running inside a server program. This program is called =epdfinfo= and its job is it to successively read requests from Emacs and produce the proper results, i.e. the PNG image of a PDF page.

  #+BEGIN_SRC emacs-lisp
    ;; This configure file comes from [[http://nasseralkmim.github.io/notes/2016/08/21/my-latex-environment/][here]]
    (use-package pdf-tools
      :ensure t
      :mode ("\\.pdf\\'" . pdf-tools-install)
      :defer t
      :config
      (setenv "PATH" (concat "C:\\APPS-SU\\msys64\\mingw64\\bin;" (getenv "PATH"))) 
      (setq mouse-wheel-follow-mouse t)
      (setq-default pdf-view-display-size 'fit-page))
   #+END_SRC

* Reftex
  Reftex is a package that helps inserting labels, references and citations.

  #+BEGIN_SRC emacs-lisp
    (use-package reftex
      :ensure t
      :defer t
      :config
      (setq reftex-cite-prompt-optional-args t)); Prompt for empty optional arguments in cite 
  #+END_SRC
* References & bibliographies
  This package configuration lets you type =C-c C-r=  to bring up a list of your references. You can then search through it til you find the one you want. Hitting =RET= inserts a citation. There are a few other things you can do besides inserting citations - have a look by highlighting a bib entry and pressing =M-o=. 

=ivy-bibtex= can also keep track of pdfs of articles and notes that you take pertaining to these articles. Since this is a "minimal" configuration, I don't set that up here. If you're interested, look at =bibtex-completion-library-path= and =bibtex-completion-notes-path=

  #+BEGIN_SRC emacs-lisp
    (use-package ivy-bibtex
      :ensure t
      :defer t
      :config 
      (setq bibtex-completion-bibliography my/bib-file-location)
      (bind-key* "C-c C-r" #'ivy-bibtex)
      ;; default is to open pdf - change that to insert citation
      (setq ivy-bibtex-default-action #'ivy-bibtex-insert-citation)
      )
  #+END_SRC

* Rmarkdown/knitr (polymode)
  Polymode is a package that lets us use emacs to edit rmarkdown and sweave-type files that combine markdown or latex with R code. Let's load it up and make it aware of the file extensions:

  #+BEGIN_SRC emacs-lisp
    (use-package polymode
      :ensure t
      :mode
      ("\\.Snw" . poly-noweb+r-mode)
      ("\\.Rnw" . poly-noweb+r-mode)
      ("\\.Rmd" . poly-markdown+r-mode))
  #+END_SRC

* Git (magit)
  Magit is an Emacs package that makes dealing with git awesome.

  #+BEGIN_SRC emacs-lisp
    (use-package magit
      :ensure t
      :bind ("C-x g" . magit-status))
  #+END_SRC

* Evil
  Evil is an extensible vi layer for Emacs. It emulates the main features of Vim, and provides facilities for writing custom extensions.

  #+BEGIN_SRC emacs-lisp
    (use-package evil
      :ensure t
      :init
      (evil-mode 1) ;;enable evil mode by default
      ;;(setq evil-default-state 'emacs) ;; enter emacs mode after initialize
      (evil-set-initial-state 'dired-mode 'emacs) ;; set to emacs mode when in dired mode
      (define-key evil-emacs-state-map (kbd "C-o") 'evil-execute-in-normal-state) ;;temporary enter evil mode
      :config
      ;; show which mode is in
      (setq evil-normal-state-tag "NORMAL")
      (setq evil-insert-state-tag "INSERT")
      (setq evil-visual-state-tag "VISUAL")
      )
  #+END_SRC

* Window move
** Window-numbering
  Numbered window shortcuts for Emacs. Other options maybe ace-window, but I prefer this one, which is a little bit consistent with the way of clover or other software switching tabs.

  #+BEGIN_SRC emacs-lisp
    (use-package window-numbering
      :ensure t
      :init
      (progn
        (window-numbering-mode t)))
  #+END_SRC
  
** Winner-mode

  #+BEGIN_SRC emacs-lisp
    (use-package winner
    :init
    (winner-mode)) 
  #+END_SRC

** Windmove

   #+BEGIN_SRC emacs-lisp
     (windmove-default-keybindings) ;; use shift + left/right to move between windows 
   #+END_SRC
   
** Ace-window

   #+BEGIN_SRC emacs-lisp
     (use-package ace-window
         :ensure t
         :init
         (setq aw-keys '(?a ?s ?d ?f ?g ?h ?j ?k ?l))
         (setq aw-dispatch-always t)
         (setq aw-background nil)
         :bind ("M-p" . ace-window)
         :config
         (custom-set-faces '(aw-leading-char-face
         ((t (:inherit ace-jump-face-foreground :height 3.0)))))
        )

  (global-set-key (kbd "<f9>")
   (defhydra hydra-window () 
      "
   Movement^^        ^Split^         ^Switch^		^Resize^
   ----------------------------------------------------------------
   _h_ ←       	_v_ertical    	_b_uffer		_q_ X←
   _j_ ↓        	_x_ horizontal	_f_ind files	_w_ X↓
   _k_ ↑        	_z_ undo      	_a_ce 1		_e_ X↑
   _l_ →        	_Z_ reset      	_s_wap		_r_ X→
   _F_ollow		_D_lt Other   	_S_ave		max_i_mize
   _SPC_ cancel	_o_nly this   	_d_elete	
   "
      ("h" windmove-left )
      ("j" windmove-down )
      ("k" windmove-up )
      ("l" windmove-right )
      ("q" hydra-move-splitter-left)
      ("w" hydra-move-splitter-down)
      ("e" hydra-move-splitter-up)
      ("r" hydra-move-splitter-right)
      ("b" helm-mini)
      ("f" helm-find-files)
      ("F" follow-mode)
      ("a" (lambda ()
             (interactive)
             (ace-window 1)
             (add-hook 'ace-window-end-once-hook
                       'hydra-window/body))
          )
      ("v" (lambda ()
             (interactive)
             (split-window-right)
             (windmove-right))
          )
      ("x" (lambda ()
             (interactive)
             (split-window-below)
             (windmove-down))
          )
      ("s" (lambda ()
             (interactive)
             (ace-window 4)
             (add-hook 'ace-window-end-once-hook
                       'hydra-window/body)))
      ("S" save-buffer)
      ("d" delete-window)
      ("D" (lambda ()
             (interactive)
             (ace-window 16)
             (add-hook 'ace-window-end-once-hook
                       'hydra-window/body))
          )
      ("o" delete-other-windows)
      ("i" ace-maximize-window)
      ("z" (progn
             (winner-undo)
             (setq this-command 'winner-undo))
      )
      ("Z" winner-redo)
      ("SPC" nil)
      ))

   #+END_SRC

* Expand-region 
  Expand region increases the selected region by semantic units. Just keep pressing the key until it selects what you want.
  #+BEGIN_SRC emacs-lisp
    (use-package expand-region
      :ensure t
      :config 
      (global-set-key (kbd "C-=") 'er/expand-region))
  #+END_SRC

* Indent
  aggressive-indent-mode is a minor mode that keeps your code always indented. It reindents after every change, making it more reliable than electric-indent-mode.
    #+BEGIN_SRC emacs-lisp
      (use-package aggressive-indent
        :ensure t
        :config
        (global-aggressive-indent-mode))
    #+END_SRC

* Which-key
   Emacs package that displays available keybindings in popup.

   #+BEGIN_SRC emacs-lisp
     (use-package which-key
       :ensure t
       :diminish ""
       :config
       (which-key-mode t))
   #+END_SRC
* Project
** Projectile 
  Projectile is a project interaction library for Emacs. Its goal is to provide a nice set of features operating on a project level without introducing external dependencies(when feasible). For instance - finding project files has a portable implementation written in pure Emacs Lisp without the use of GNU find (but for performance sake an indexing mechanism backed by external commands exists as well).
  #+BEGIN_SRC emacs-lisp
    (use-package projectile
      :ensure t
      :config
      (projectile-global-mode)
      (setq projectile-enable-caching t)
      (setq projectile-completion-system 'ivy))
    
    (use-package counsel-projectile
      :ensure t
      :defer t
      :config
      (counsel-projectile-on))
    
    (use-package ag
      :ensure t
      :commands (ag ag-files ag-regexp ag-project ag-dired)
      :config 
      (setq ag-highlight-search t)
      (setq ag-reuse-buffers 't))
    
    (use-package ripgrep
      :ensure t)

    (use-package projectile-ripgrep
      :ensure t)
  #+END_SRC
  
** Search tools
   Ag and ripgrep are too command line search tools that are alternatives to grep but with are relatively more efficient.

  #+BEGIN_SRC emacs-lisp
    (use-package ag
      :ensure t
      :commands (ag ag-files ag-regexp ag-project ag-dired)
      :config 
      (setq ag-highlight-search t)
      (setq ag-reuse-buffers 't))
    
    (use-package ripgrep
      :ensure t)

    (use-package projectile-ripgrep
      :ensure t)
  #+END_SRC

* Swiper / Ivy / Counsel
  Swiper gives us a really efficient incremental search with regular expressions and Ivy / Counsel replace a lot of ido or helms completion functionality.

  #+BEGIN_SRC emacs-lisp  
   (use-package counsel
     :ensure t
     :bind
     (("M-y" . counsel-yank-pop)
     :map ivy-minibuffer-map
     ("M-y" . ivy-next-line)))


   (use-package ivy
     :ensure t
     :diminish (ivy-mode)
     :bind (("C-x b" . ivy-switch-buffer))
     :config
     (ivy-mode 1)
     (setq ivy-use-virtual-buffers t)
     (setq ivy-display-style 'fancy))


   (use-package swiper
     :ensure t
     :bind (("C-s" . swiper)
            ("M-r" . counsel-rg) ;; http://oremacs.com/ recommend use rg as an main search tool
            ("C-c C-r" . ivy-resume)
            ("M-x" . counsel-M-x))
     :config
     (progn
       (ivy-mode 1)
       (setq ivy-use-virtual-buffers t)
       (setq ivy-display-style 'fancy)
       (define-key read-expression-map (kbd "C-r") 'counsel-expression-history)
       ))
  #+END_SRC

* Avy
  avy is a GNU Emacs package for jumping to visible text using a char-based decision tree. 
  #+BEGIN_SRC emacs-lisp
    (use-package avy
    :ensure t
    :bind ("M-s" . avy-goto-char-2))
  #+END_SRC

* Flycheck 
  Modern on-the-fly syntax checking extension for GNU Emacs.

  #+BEGIN_SRC emacs-lisp
    (use-package flycheck
      :ensure t
      :init (global-flycheck-mode))
  #+END_SRC

Then press C-M-x with point somewhere in this form to install and enable Flycheck for the current Emacs session.

* Smex 
  Smex is a M-x enhancement for Emacs. Built on top of Ido, it provides a convenient interface to your recently and most frequently used commands. And to all the other commands, too.
  #+BEGIN_SRC emacs-lisp
   (use-package smex
     :disabled ;; not needed since we get counsel-M-x
     :ensure t
     :bind (("M-x" . smex)
            ("M-X" . smex-major-mode-commands))
     :config
     (progn
      (smex-initialize))) 
  #+END_SRC

* YASnippet 
  YASnippet is a template system for Emacs. It allows you to type an abbreviation and automatically expand it into function templates. Bundled language templates include: C, C++, C#, Perl, Python, Ruby, SQL, LaTeX, HTML, CSS and more. The snippet syntax is inspired from TextMate's syntax, you can even import most TextMate templates to YASnippet. 

   #+BEGIN_SRC emacs-lisp
     (use-package yasnippet
       :ensure t
       :defer t
       :commands (yas-minor-mode) ; autoload `yasnippet' when `yas-minor-mode' is called
                                             ; using any means: via a hook or by user
                                             ; Feel free to add more commands to this
                                             ; list to suit your needs.
       :config ; stuff to do before requiring the package
       (progn
         (add-hook 'prog-mode-hook #'yas-minor-mode))
       :config ; stuff to do after requiring the package
       (progn
         (yas-reload-all)))
   #+END_SRC

* Org-mode

   #+BEGIN_SRC emacs-lisp
     (use-package org-bullets
       :ensure t
       :config
       (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1))))

     (defhydra hydra-org (:color red :columns 3) 
       "Org Mode Movements"
       ("n" outline-next-visible-heading "next heading")
       ("p" outline-previous-visible-heading "prev heading")
       ("N" org-forward-heading-same-level "next heading at same level")
       ("P" org-backward-heading-same-level "prev heading at same level")
       ("u" outline-up-heading "up heading")
       ("g" org-goto "goto" :exit t))
     (add-hook 'org-mode-hook
          (lambda () (local-set-key (kbd "<f8>") #'hydra-org/body)))
   #+END_SRC
* IBUFFER

  #+BEGIN_SRC emacs-lisp
    (global-set-key (kbd "C-x C-b") 'ibuffer)
    (setq ibuffer-saved-filter-groups
  	(quote (("default"
  		 ("dired" (mode . dired-mode))
  		 ("org" (name . "^.*org$"))
  	       
  		 ("web" (or (mode . web-mode) (mode . js2-mode)))
  		 ("shell" (or (mode . eshell-mode) (mode . shell-mode)))
  		 ("mu4e" (or
  
                   (mode . mu4e-compose-mode)
                   (name . "\*mu4e\*")
                   ))
  		 ("programming" (or
  				 (mode . python-mode)
  				 (mode . c++-mode)))
  		 ("emacs" (or
  			   (name . "^\\*scratch\\*$")
  			   (name . "^\\*Messages\\*$")))
  		 ))))
    (add-hook 'ibuffer-mode-hook
  	    (lambda ()
  	      (ibuffer-auto-mode 1)
  	      (ibuffer-switch-to-saved-filter-groups "default")))
  
    ;; don't show these
  					  ;(add-to-list 'ibuffer-never-show-predicates "zowie")
    ;; Don't show filter groups if there are no buffers in that group
    (setq ibuffer-show-empty-filter-groups nil)
  
    ;; Don't ask for confirmation to delete marked buffers
    (setq ibuffer-expert t)
  
  #+END_SRC
* Google
  Google-this is a set of emacs functions and bindings to google under point.
  #+BEGIN_SRC emacs-lisp
    ;; google-this
    (use-package google-this
      :ensure
      :config
      (google-this-mode 1)) 
  #+END_SRC
  
 Gscholar-bibtex allows you to retrieve BibTeX entries from Google Scholar, ACM Digital Library, IEEE Xplore and DBLP.
  #+BEGIN_SRC emacs-lisp
    (use-package gscholar-bibtex
      :ensure
      :commands gscholar-bibtex
      :init
      (setq gscholar-bibtex-database-file "~/.emacs.d/research.bib")
      :config
      (dolist (source '("ACM Digital Library" "IEEE Xplore" "DBLP"))
        (gscholar-bibtex-source-on-off :off source))
      (setq gscholar-bibtex-default-source "Google Scholar"))  
  #+END_SRC
